// auto generated by github.com/sakura-rip tool
// DO NOT EDIT

package {{.PackageName}}

import (
    "go.mongodb.org/mongo-driver/bson/primitive"
)

func (cl *DBClient) Insert{{.Name}}One({{.LowerName}} *{{.Name}}) (string, error) {
    result, err := cl.{{.Name}}Col.InsertOne(cl.ctx, {{.LowerName}})
    if err != nil {
        return "", err
    }
    if oid, ok := result.InsertedID.(primitive.ObjectID); ok {
        return oid.Hex(), nil
    }
    return "", nil
}

func (cl *DBClient) Insert{{.Name}}Many({{.LowerName}} []*{{Name}}) ([]string, error) {
    result, err := cl.{{.Name}}Col.InsertMany(cl.ctx, {{.lowerName}})
    if err != nil {
        return nil, err
    }
    var strOids []string
    if oids, ok := result.InsertedIDs.([]primitive.ObjectID); ok {
        for _, oid := range oids {
            strOids = append(strOids, oid.Hex())
        }
        return strOids, nil
    }
    return strOids, nil
}

func (cl *DBClient) Update{{.Name}}Attribute(id string, attrToUpdate bson.D) error {
    _, err := cl.{{.Name}}Col.UpdateOne(cl.ctx, bson.M{"_id": id}, bson.M{"$set": attrToUpdate})
    return err
}

func (cl *DBClient) Delete{{.Name}}Attribute(id string, attrToDelete bson.D) error {
    _, err := cl.{{.Name}}Col.UpdateOne(cl.ctx, bson.M{"_id": id), bson.M{"$unset": attrToDelete)
    return err
}

func (cl *DBClient) AddTo{{.Name}}Array(id string, object bson.M) error {
    _, err := cl.{{.Name}}Col.UpdateOne(cl.Ctx, bson.M{"_id": id}, bson.M{"$addToSet": object})
    return err
}

func (cl *DBClient) RemoveFrom{{.Name}}Array(id string, object bson.M) error {
    _, err := cl.{{.Name}}Col.UpdateOne(cl.Ctx, bson.M{"_id": id}, bson.M{"$pull": targets})
    return err
}
