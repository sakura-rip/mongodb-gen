// auto generated by github.com/sakura-rip tool
// Version : [[version]]
// DO NOT EDIT

package dao

import (
    "go.mongodb.org/mongo-driver/bson/primitive"
    "go.mongodb.org/mongo-driver/bson"
    "go.mongodb.org/mongo-driver/mongo/options"
)

func (cl *[[.Name]]DaoClient) DeleteOne(id string) (int64, error) {
    result, err := cl.Col.DeleteOne(cl.ctx, bson.M{"_id": id})
    if err != nil {
        return 0, err
    }
    return result.DeletedCount, err
}

func (cl *[[.Name]]DaoClient) DeleteMany(attr bson.M) (int64, error) {
    result, err := cl.Col.DeleteMany(cl.ctx, attr)
    if err != nil {
        return 0, err
    }
    return result.DeletedCount, err
}

func (cl *[[.Name]]DaoClient) InsertOne([[.LowerName]] *[[.PackageName]].[[.Name]]) (string, error) {
    result, err := cl.Col.InsertOne(cl.ctx, [[.LowerName]])
    if err != nil {
        return "", err
    }
    if oid, ok := result.InsertedID.(primitive.ObjectID); ok {
        return oid.Hex(), nil
    }
    return "", nil
}

func (cl *[[.Name]]DaoClient) InsertMany(objs []interface{}) ([]string, error) {
    result, err := cl.Col.InsertMany(cl.ctx, objs)
    if err != nil {
        return nil, err
    }
    var strIds []string
	for _, id := range result.InsertedIDs {
		strIds = append(strIds, id.(primitive.ObjectID).Hex())
		return strIds, nil
	}
    return strIds, nil
}

func (cl *[[.Name]]DaoClient) UpdateAttribute(id string, attrToUpdate bson.D) error {
    _, err := cl.Col.UpdateOne(cl.ctx, bson.M{"_id": id}, bson.M{"$set": attrToUpdate})
    return err
}

func (cl *[[.Name]]DaoClient) DeleteAttributes(id string, attrToDelete ...string) error {
	var projections = bson.D{}
	for _, attribute := range attrToDelete {
		projections = append(projections, bson.E{Key: attribute, Value: 1})
	}
	_, err := cl.Col.UpdateOne(cl.ctx, bson.M{"_id": id}, bson.M{"$unset": projections})
	return err
}

func (cl *[[.Name]]DaoClient) AddToArray(id string, object bson.M) error {
    _, err := cl.Col.UpdateOne(cl.ctx, bson.M{"_id": id}, bson.M{"$addToSet": object})
    return err
}

func (cl *[[.Name]]DaoClient) RemoveFromArray(id string, object bson.M) error {
    _, err := cl.Col.UpdateOne(cl.ctx, bson.M{"_id": id}, bson.M{"$pull": object})
    return err
}

func (cl *[[.Name]]DaoClient) Get(filter bson.M) ([][[.PackageName]].[[.Name]], error) {
	res, err := cl.Col.Find(
		cl.ctx, filter)
	if err != nil {
		return nil, err
	}
	var [[.LowerName]]s [][[.PackageName]].[[.Name]]
	if err := res.Decode(&[[.LowerName]]s); err != nil {
		return nil, err
	}
	return [[.LowerName]]s, err
}

func (cl *[[.Name]]DaoClient) Get[[.Name]](id string) ([[.PackageName]].[[.Name]], error) {
	res := cl.Col.FindOne(
		cl.ctx,
		bson.D{{"_id", id}},
	)
	var [[.LowerName]] [[.PackageName]].[[.Name]]
	if err := res.Decode(&[[.LowerName]]); err != nil {
		return [[.LowerName]], err
	}
	return [[.LowerName]], nil
}

func (cl *[[.Name]]DaoClient) FetchAll() ([][[.PackageName]].[[.Name]], error) {
    res, _ := cl.Col.Find(cl.ctx, bson.M{})
    var [[.LowerName]]s [][[.PackageName]].[[.Name]]
    if err := res.All(cl.ctx, &[[.LowerName]]s); err != nil {
        return [[.LowerName]]s, err
    }
    return [[.LowerName]]s, nil
}

func (cl *[[.Name]]DaoClient) FetchAttribute(id string, attributes bson.D) ([[.PackageName]].[[.Name]], error) {
	res := cl.Col.FindOne(
		cl.ctx,
		bson.D{{"_id", id}},
		options.FindOne().SetProjection(attributes),
	)
	var [[.LowerName]] [[.PackageName]].[[.Name]]
	if err := res.Decode(&[[.LowerName]]); err != nil {
		return [[.LowerName]], err
	}
	return [[.LowerName]], nil
}

func (cl *[[.Name]]DaoClient) FetchAttributes(id string, attributes ...string) ([[.PackageName]].[[.Name]], error) {
	var projections = bson.D{}
	for _, attribute := range attributes {
		projections = append(projections, bson.E{Key: attribute, Value: 1})
	}
	return cl.FetchAttribute(id, projections)
}
